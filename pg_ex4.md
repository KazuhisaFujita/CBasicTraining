
## 第4回 じゃんけんプログラムの作成

### 目的

じゃんけんのプログラムを作成を通し，これまで習ったC言語の知識の復習をする．

### じゃんけんプログラム

じゃんけんとは，２人不完全情報ゲームの一つである．じゃんけんは，２人のプレーヤーがグー，チョキ，パーのいずれかの手を同時に出し，グーとチョキが出た場合はグーを出したプレーヤが，チョキとパーが出た場合はチョキを出したプレーヤが，パーとグーが出た場合はパーを出したプレーヤが勝利するゲームである．

本実験では，このゲームをC言語プログラムで実装する．このゲームをプログラム上で実現する場合は，プレーヤの手を数値で表現する必要がある．今回は，グー，チョキ，パーそれぞれの0，1．2の数値で表すことにする．これを踏まえ，作られたじゃんけんプログラムをリスト4.1に示す．

```c
 1	/******************************
 2	リスト4.1 じゃんけんプログラム
 3
 4	じゃんけんの手
 5	グー  : 0
 6	チョキ: 1
 7	パー  : 2
 8	******************************/
 9	#include <stdio.h>
10
11	int main(void)
12	{
13	    int player = 0;
14	    int enemy = 0;
15
16		printf("自分のじゃんけんの手を入力してください．\n");
17	    scanf("%d", &player);
18		printf("相手のじゃんけんの手を入力してください．\n");
19	    scanf("%d", &enemy);
20
21	    if(player == enemy){
22	        printf("引き分け\n");
23	    }else if(player == 0 && enemy == 1){
24	        printf("勝ち\n");
25	    }else if(player == 1 && enemy == 2){
26	        printf("勝ち\n");
27	    }else if(player == 2 && enemy == 0){
28	        printf("勝ち\n");
29	    }else{
30	        printf("負け\n");
31	    }
32
33	    return(0);
34	}
```

ここで本実験で初めて，キーボードからの入力を行う関数scanfを使った．scanfの使い方は

```c
scanf("変数指定子", &変数名);
```

となる．scanfで用いる指定子を下記の表に示す．指定子は実験1で用いたprintfと似ているが，double型を取り扱う場合は%lfとなることに注意しよう．また，scanfの書式を理解するためには，発展的な内容を知る必要がある．今は呪文だと思って使ってほしい．

| 指定子  | 意味 |
|:-----:|:------------:|
| %d | int型の変数を読み込む |
| %f | float型の変数を読み込み |
| %lf | double型の変数を読み込み |

__課題4.1__ リスト4.1のフローチャートをかけ．

### 乱数を使ったじゃんけんプログラム

先ほどのじゃんけんプログラムは，2人のプレイヤーの手を入力する必要があるため，1人で遊べるプログラムにはなっていない．一人で遊べるようにするためには，一人のプレーヤーの手をコンピュータが選ぶように変更する必要がある．コンピュータがプレーヤーの手を決めるときによく用いられるのが乱数である．乱数とは，ある確率に従って生成される数のことである．多くのプログラミングの書籍で乱数と書いてある場合は，すべての数が等しい確率で出現する乱数(一様乱数)のことを示す場合がほとんどである．乱数を使ったC言語のサンプルプログラムをリスト4.2に示す．

```c
 1	/*リスト4.2*/
 2	#include <stdio.h>
 3	#include <stdlib.h>
 4
 5	int main(void)
 6	{
 7	    int a;
 8
 9	    /*乱数の種の初期化*/
10	    srand((unsigned) time(NULL));
11
12	    a = rand()%3;
13		printf("%d\n", a);
14
15	    return(0);
16	}
```

この乱数のサンプルプログラムは，生成した乱数を表示する．このプログラムでは，乱数に組み込み関数であるrand()を用いている．rand()は，0からRAND_MAXまでの整数のうち1つを返す関数である．それぞれの整数の出現確率は等しい．この関数を使うためには，まずstdlib.hをインクルードする必要がある．

8行目のsrand((unsigned) time(NULL))は乱数の初期値（種）に現時刻を与える処理を行っている．乱数の種の初期化をしなかった場合，プログラムを何度実行しても同じ乱数が生成される．乱数の種を現時刻とすることで，起動するたびに乱数の種が現時刻となり，毎回違った乱数が生成される事となる．

乱数のサンプルプログラムを実行すると，0から2までの数値しか表示されない．これは，rand()関数で生成した整数を3で割った余り(剰余)を表示しているからである．このように，剰余を使えば任意の範囲の整数の乱数を生成できる．

__発展__ 組み込み関数のrand()は実は出て来る数値が決まっており，その数値の並びの周期が短い．そのため科学技術計算などでは，より良い乱数を使う必要がある．興味があれば調べてみよう．

__課題4.2__ 先ほど作成したじゃんけんプログラムのplayer2の手を乱数で決め，人間とコンピュータがじゃんけんをするプログラムに書き換え，変更箇所を報告せよ．


### 無限ループとbreak文

無限ループとは，名前の通り無限にループを繰り返す処理のことである．しかし，プログラムは必ず停止しなければならないため，無限ループを抜ける適切な条件分が必ず必要となる．ループを強制的に抜けるための命令がbrake文である．では，次にfor文を使った無限ループとbrake文を使った例を見てみよう．

```c
for(;;){
    処理
    if(条件式){
        break;
    }
}
```

このプログラムは，条件式が真となった場合brake文が実行され，ループを抜けるように作られている．次に，無限ループを用いたプログラムの例をリストに示す．このリスト4.3は，0から2までの乱数を発生させ，0が出たら終了するプログラムである．このプログラムは0が出ない限りforループが回り続け，0が出た場合if文内のbreakが実行されループを抜け終了する．

```c
 1	/*リスト4.3*/
 2	#include <stdio.h>
 3	#include <stdlib.h>
 4
 5	int main(void)
 6	{
 7	    int a;
 8	    srand((unsigned) time(NULL));
 9
10	    for(;;){
11	        a = rand()%3;
12	        printf("%d\n", a);
13	        if(a == 0){
14	            break;
15	        }
16	    }
17	    return(0);
18	}
```

__課題4.3__ 人間がコンピュータに勝つまでじゃんけんを繰り返すプログラムのためのフローチャートをかけ．(ヒント：勝ち負けの結果を保存する変数を使う)

__課題4.4__ 課題4.3で描いたフローチャートに基づきプログラムを作成し，ソースコードを提出せよ．

__課題4.5__ 人間がコンピュータに3回勝つまでじゃんけんを繰り返すプログラムを作成し，ソースコードを提出せよ．

__課題4.6(発展)__ 0から1までの乱数をrand()を用い生成させる処理を報告せよ．ただし，乱数は浮動小数とせよ．

__課題4.7(発展)__ 三回勝負を10回行い，人間及びコンピュータの勝率を表示するプログラムを作成し，ソースコードを提出せよ．

__課題4.8(発展)__ この実験ではじゃんけんの勝敗条件処理を愚直に記述してあるため，ソースコードが長くなっている，より短く記述することも可能である．じゃんけんの勝敗条件の処理を短くしたプログラムを作成し，どのようにして短くしたかを報告せよ．

__課題4.10(発展)__ サンプルコードと課題のプログラムは，無限ループとbrake文を使わなくても実装できる．課題4.4のプログラムをfor文のみ使ったbrakeを使わないプログラムに書き換え，ソースコードを印刷して提出せよ．
